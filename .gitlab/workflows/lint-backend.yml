.lint-backend-template:
  stage: lint
  image: python:3.13-alpine
  script:
    - cd apps/backend
    - python -m pip install --upgrade pip
    - pip install -r requirements/test.txt
    - mypy src tests
    - ruff check .
    - ruff format --check
  rules:
    - if: '$CI_COMMIT_REF_NAME == "main"'
      when: on_success
    - if: '$CI_PIPELINE_SOURCE == "merge_request_event"'
      changes:
        - apps/backend/**/*
        - compose.yml
      when: on_success
    - when: never